SET(PLUGINS "${LIB_INSTALL_DIR}/vookiimageviewer/imageformats")

INSTALL(TARGETS ${APPLICATION_NAME} ${IMAGE_PLUGINS}
    RUNTIME DESTINATION bin
    LIBRARY DESTINATION ${PLUGINS})

GET_FILENAME_COMPONENT(TOP_LEVEL_ABSOLUTE_PATH ../../ ABSOLUTE)
INSTALL(FILES ${TOP_LEVEL_ABSOLUTE_PATH}/LICENSE
        ${TOP_LEVEL_ABSOLUTE_PATH}/LICENSE-IMAGES
        ${TOP_LEVEL_ABSOLUTE_PATH}/LICENSE-OPENCLIPART
        ${TOP_LEVEL_ABSOLUTE_PATH}/LICENSE-PLUGINS-KIMAGEFORMATS
        ${TOP_LEVEL_ABSOLUTE_PATH}/README.md
        DESTINATION share/doc/vookiimageviewer)

INSTALL(FILES ${TOP_LEVEL_ABSOLUTE_PATH}/build/cmake/platform/unix/support/vookiimageviewer.desktop
        DESTINATION share/applications)

INSTALL(FILES ${TOP_LEVEL_ABSOLUTE_PATH}/src/resource/openclipart/vookiimageviewericon.png
        DESTINATION share/pixmaps)

INCLUDE(CPack.cmake)

if(NOT CPACK_GENERATOR)
    SET(CPACK_GENERATOR DEB)
endif()

foreach(GENERATOR IN LISTS CPACK_GENERATOR)
    MESSAGE("-- ${GENERATOR} packaging requested")

    if(GENERATOR MATCHES "DEB")
        SET(CPACK_VERBATIM_VARIABLES YES)

        SET(CPACK_PACKAGE_CONTACT "github@vookimedlo.cz")
        SET(CPACK_DEBIAN_PACKAGE_MAINTAINER "Michal Duda")
        SET(CPACK_DEBIAN_FILE_NAME DEB-DEFAULT)
        SET(CPACK_DEBIAN_PACKAGE_SECTION "contrib")
        SET(CPACK_DEBIAN_COMPRESSION_TYPE "zstd")
        SET(CPACK_DEBIAN_PACKAGE_PRIORITY "optional")
        SET(CPACK_DEBIAN_PACKAGE_SHLIBDEPS ON)
        SET(CPACK_DEBIAN_PACKAGE_RECOMMENDS "qt6-image-formats-plugins")
        SET(CPACK_DEBIAN_DEBUGINFO_PACKAGE OFF)
    endif()

endforeach()

include(CPack)