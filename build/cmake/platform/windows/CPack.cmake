INSTALL(TARGETS ${APPLICATION_NAME}
        RUNTIME DESTINATION ".")
INSTALL(TARGETS ${IMAGE_PLUGINS}
        LIBRARY DESTINATION "imageformats")
INSTALL(FILES ${LIBDE265} ${LIBHEIF}
        DESTINATION ".")
INSTALL(FILES platform/windows/support/package/gpl-3.0.rtf
        DESTINATION ".")

SET(CMAKE_INSTALL_SYSTEM_RUNTIME_DESTINATION ".")
INCLUDE(InstallRequiredSystemLibraries)
SET(CMAKE_INSTALL_UCRT_LIBRARIES TRUE)

FIND_PROGRAM(WINDEPLOYQT windeployqt HINTS "${_qt_bin_dir}")
CONFIGURE_FILE("platform/Windows/WindeployQt-CPack.cmake.in" "${CMAKE_BINARY_DIR}/WindeployQt-CPack.cmake" @ONLY)

SET(CPACK_PRE_BUILD_SCRIPTS ${CMAKE_BINARY_DIR}/WindeployQt-CPack.cmake)

SET(CPACK_PACKAGE_VENDOR "Michal Duda")
SET(CPACK_PACKAGE_VERSION "${VERSION}")
SET(CPACK_PACKAGE_INSTALL_DIRECTORY ${APPLICATION_NAME})
SET(CPACK_PACKAGE_EXECUTABLES ${APPLICATION_NAME};${APPLICATION_NAME})

if(NOT CPACK_GENERATOR)
        SET(CPACK_GENERATOR ZIP)
endif()

include(CPack)

